<link rel="stylesheet" href="../../bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="../../css/preview-image.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<style>
    .input {
        background-color: #DFDFDF;
    }

    .form-control-file {
        width: 0.1px;
        height: 0.1px;
        opacity: 0;
        overflow: hidden;
        position: absolute;
        z-index: -1;
    }

    .btn-add-img {
        color: white;
        padding: 5px 20px;
        background-color: #FF000A;
        border-radius: 15px;
    }

    #show-img {
        width: 200px;
        height: 100px;
        text-align: center;
        border-radius: 15px;
        background-image: url(../../image/bg_img.png);
        background-position: center;
        background-repeat: no-repeat;
        background-size: 80px;
    }
</style>

<div class="p-4" style="height: 80px;">
    <h2>THÊM TIN TỨC</h2>
</div>
<form action="/news/add-news" method="post" enctype="multipart/form-data" class="pr-5 pl-5 pb-5">

    <div class="shadow p-3 bg-white d-flex flex-row mb-3" style=" width:100%; border-radius: 15px; margin-right: 10px;">
        <div style=" text-align: center;">
            <div class="shadow form-group" id="show-img">
                <input type="file" class="form-control-file" id="pictureNews0" name="pictureNews">
                <br>
            </div>
            <label for="pictureNews0" class="btn-add-img">Thêm ảnh</label>
        </div>
        <div class="form-group pl-3" style="width: 100%;">
            <textarea class="form-control input bg-white" id="contentNews0" rows="3" name="desProduct"
                style="max-width: 100%;" placeholder="Nhập tiêu đề..."></textarea>
        </div>
    </div>

    <div class="shadow p-3 bg-white" style=" width:100%; border-radius: 15px; margin-right: 10px;">
        <div class="row ml-2">
            <div id="dynamicCheck" style="width: 30px; height: 30px;" onclick="remove();">
                <img src="../../image/remove-elemnt-news.svg" width="100%" height="100%">
            </div>
            <div id="dynamicCheck" class="text-center font-weight-bold"
                style="width: 30px; height: 30px;  font-size: 18px;">
                <p>2</p>
            </div>
            <div id="dynamicCheck" style="width: 30px; height: 30px;" onclick="add();">
                <img src="../../image/add-elemnt-news.svg" width="100%" height="100%">
            </div>
        </div>
        <div id="newElementNews">

        </div>
    </div>

    <div class="col p-5" style="margin: auto; text-align: center">
        <input type="submit" class="btn btn-primary" style="width: 300px;" />

    </div>
</form>
<script>

    var i = 0;
    function add() {
        i++;
        console.log(i);
        var newElementNews = document.createElement('div');
        // Then add the content (a new input box) of the element.
        newElementNews.innerHTML =
            "<div class='shadow p-3 bg-white d-flex mt-3' style=' width:100%; border-radius: 15px; margin-right: 10px;' id='elementNews" + i + "'>" +
            "<div style=' text-align: center;'>" +
            "<div class='shadow form-group field' id='show-img'>" +
            "<input type='file' class='form-control-file' id='pictureNews0' name='pictureNews'>" +
            "<br>" +
            "</div>" +
            "<label for='pictureNews0' class='btn-add-img'>Thêm ảnh</label>" +
            "</div>" +
            "<div class='form-group pl-3' style='width: 100%;'>" +
            "<textarea class='form-control input bg-white' id='contentNews" + i + "' rows='3' name='desProduct'" +
            "style='max-width: 100%;' placeholder='Nhập nội dung...'></textarea>" +
            "</div>" +
            "</div>"
        // Finally put it where it is supposed to appear.
        document.getElementById("newElementNews").appendChild(newElementNews);
    }

    function remove() {
        var elementNews = document.getElementById("elementNews" + i);
        if (i <= 0) {
            i = 1;
            console.log(i);
        } else {
            elementNews.remove();
            console.log(i);
        }
        i--;
    }

     document.getElementById("pictureNews0").onclick = function () {
            removePriviewImage();
        }
        function removePriviewImage() {
            var pip = document.getElementsByClassName("pip");
            var pipLength = pip.length;
            for (var i = 0; i < pipLength; i++) {
                pip[0].remove();
            }
        }
        $(document).ready(function () {
            if (window.File && window.FileList && window.FileReader) {
                $("#pictureNews0").on("change", function (e) {
                    var files = e.target.files,
                        filesLength = files.length;
                    for (var x = 0; x < filesLength; x++) {
                        var f = files[x]
                        if (!/\.(jpe?g|png|gif)$/i.test(f.name)) {
                            alert("Hãy chọn ảnh");
                            document.getElementById("pictureNews0").value = null;
                            return false;
                        }
                        var fileReader = new FileReader();
                        fileReader.onload = (function (e) {
                            var file = e.target;
                            if (document.getElementById("pictureNews0").value == "") {
                                $("");
                            } else {
                                $("<span class='pip'>" +
                                    "<img class=\"imageThumb\" src=\"" + e.target.result + "\" title=\"" + file.name + "\"/>" +
                                    "</span>").insertAfter("#pictureNews0");
                            }
                        });
                        fileReader.readAsDataURL(f);
                    }
                });
            } else {
                alert("Your browser doesn't support to File API")
            }
        });
</script>